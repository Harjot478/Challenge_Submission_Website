
<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>Challenge Submission</title>
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<header>
			<nav class="main-nav" role="navigation" aria-label="Main navigation">
				<a class="nav-button" href="#home">Home</a>
				<a class="nav-button" href="#post-challenge">Post a Challenge (Company)</a>
				<a class="nav-button" href="#view-challenges">View Challenges (Students)</a>
				<a class="nav-button" href="#submit-work">Submit Work</a>
				<a class="nav-button" href="#past-winners">Past Winners</a>
			</nav>
		</header>

		<main id="home" class="section">
			<h1>Home</h1>
			<p>Use the navigation above to explore the site.</p>
		</main>

		<section id="post-challenge" class="section">
			<h1>Post a Challenge (Company)</h1>
			<p>Companies can add a new challenge here. (Placeholder content.)</p>
		</section>

		<section id="view-challenges" class="section">
			<h1>View Challenges (Students)</h1>
			<p>Students can browse current challenges. (Placeholder content.)</p>
		</section>

		<section id="submit-work" class="section submit-section">
			<h1>Submit Your Work</h1>
			<p>Please complete the form below to enter a challenge.</p>
			<div class="iframe-wrap" data-src="https://docs.google.com/forms/d/e/1FAIpQLScHolwY_JJs9W6CjaF-xNmH-4g-SQQiduZ3P5aL7M4uxV8VkA/viewform?embedded=true"></div>
		</section>

		<section id="past-winners" class="section">
			<h1>Past Winners</h1>
			<p>See previous winners and their submissions. (Placeholder content.)</p>
		</section>

		<script>
			document.addEventListener('DOMContentLoaded', function(){
				const navButtons = document.querySelectorAll('.main-nav .nav-button');
				const sections = document.querySelectorAll('.section');
				const iframeWrap = document.querySelector('#submit-work .iframe-wrap');

				function showSection(id) {
					sections.forEach(s => s.classList.toggle('active', s.id === id));
					navButtons.forEach(b => b.classList.toggle('active', b.getAttribute('href') === '#' + id));

					// Lazy-load the iframe when submit-work is shown; remove when hidden
					if (id === 'submit-work') {
						if (iframeWrap && !iframeWrap.querySelector('iframe')) {
							const ifr = document.createElement('iframe');
							ifr.src = iframeWrap.dataset.src;
							ifr.width = '700';
							ifr.height = '520';
							ifr.style.width = '700px';
							ifr.style.height = '520px';
							ifr.setAttribute('frameborder', '0');
							ifr.setAttribute('marginheight', '0');
							ifr.setAttribute('marginwidth', '0');
							ifr.textContent = 'Loading…';
							ifr.loading = 'lazy';
							ifr.title = 'Submit Work Form';
							iframeWrap.appendChild(ifr);

							// If the iframe is same-origin we can detect navigation after submit
							ifr.addEventListener('load', () => {
								try {
									const href = ifr.contentWindow.location.href || '';
									if (href.includes('formResponse') || href.includes('formResponse?') || href.includes('formResponse/')) {
										window.location.href = 'thankyou.html';
									}
								} catch (err) {
									// Cross-origin iframe — cannot access location; no-op
								}
							});
						}
					} else {
						if (iframeWrap) {
							const existing = iframeWrap.querySelector('iframe');
							if (existing) existing.remove();
						}
					}
				}

				navButtons.forEach(btn => {
					btn.addEventListener('click', function(e){
						e.preventDefault();
						const target = this.getAttribute('href').replace('#','');
						showSection(target);
						history.replaceState(null, '', '#' + target);
					});
				});

				// Initial state: show based on hash or default to home
				const initial = location.hash ? location.hash.replace('#','') : 'home';
				showSection(initial);
			});
		</script>
	</body>
</html>

